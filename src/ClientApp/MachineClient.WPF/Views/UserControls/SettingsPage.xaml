<UserControl x:Class="MachineClient.WPF.Views.UserControls.SettingsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes">
    
    <Grid Margin="12">
        <TabControl Style="{StaticResource MaterialDesignTabControl}">
            
            <!-- General Settings Tab -->
            <TabItem Header="General">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                    <StackPanel>
                        
                        <!-- Connection Settings -->
                        <materialDesign:Card Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Text="Connection Settings" 
                                           FontSize="20" FontWeight="Medium"
                                           Margin="0,0,0,16"/>
                                
                                <StackPanel Grid.Row="1">
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="API URL:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" Text="{Binding ApiBaseUrl}" 
                                                 materialDesign:HintAssist.Hint="http://localhost:5275"
                                                 Margin="8,0,0,0"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Timeout (s):" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" Text="{Binding ApiTimeoutSeconds}" 
                                                 materialDesign:HintAssist.Hint="30"
                                                 Margin="8,0,0,0"/>
                                    </Grid>
                                    
                                    <CheckBox IsChecked="{Binding AutoStartConnection}" 
                                              Content="Auto-connect on startup"
                                              Margin="0,0,0,12"/>
                                    
                                    <Button Content="Save Settings" 
                                            Command="{Binding SaveApiSettingsCommand}"
                                            materialDesign:ButtonAssist.CornerRadius="4"
                                            HorizontalAlignment="Left"
                                            Padding="12,6"
                                            MinWidth="120"/>
                                </StackPanel>
                            </Grid>
                        </materialDesign:Card>
                        
                        <!-- Application Settings -->
                        <materialDesign:Card Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Text="Application Settings" 
                                           FontSize="20" FontWeight="Medium"
                                           Margin="0,0,0,16"/>
                                
                                <StackPanel Grid.Row="1">
                                    <CheckBox IsChecked="{Binding EnableFileLogging}" 
                                              Content="Enable file logging"
                                              Margin="0,0,0,12"/>
                                    
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Log Level:" VerticalAlignment="Center"/>
                                        <ComboBox Grid.Column="1" SelectedItem="{Binding LogLevel}" 
                                                  Margin="8,0,0,0" MinWidth="100">
                                            <ComboBoxItem Content="Debug"/>
                                            <ComboBoxItem Content="Info"/>
                                            <ComboBoxItem Content="Warning"/>
                                            <ComboBoxItem Content="Error"/>
                                        </ComboBox>
                                    </Grid>
                                </StackPanel>
                            </Grid>
                        </materialDesign:Card>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Backup Tab -->
            <TabItem Header="Backup">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                    <StackPanel>
                        
                        <!-- Backup Settings -->
                        <materialDesign:Card Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Text="Backup Settings" 
                                           FontSize="20" FontWeight="Medium"
                                           Margin="0,0,0,16"/>
                                
                                <StackPanel Grid.Row="1">
                                    <!-- Backup Plan -->
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Backup Plan:" VerticalAlignment="Center"/>
                                        <ComboBox Grid.Column="1" 
                                                  SelectedItem="{Binding BackupPlan}"
                                                  Margin="8,0,0,0">
                                            <ComboBoxItem Content="Hourly"/>
                                            <ComboBoxItem Content="Daily"/>
                                            <ComboBoxItem Content="Weekly"/>
                                            <ComboBoxItem Content="Manual"/>
                                        </ComboBox>
                                    </Grid>
                                    
                                    <!-- Enable Scheduled Backup -->
                                    <CheckBox IsChecked="{Binding EnableScheduledBackup}" 
                                              Content="Enable scheduled backup"
                                              Margin="0,0,0,12"/>
                                    
                                    <!-- Backup Time -->
                                    <Grid Margin="0,0,0,12" IsEnabled="{Binding EnableScheduledBackup}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Backup Time:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" 
                                                 Text="{Binding BackupTimeDisplay, Mode=TwoWay}" 
                                                 materialDesign:HintAssist.Hint="HH:mm"
                                                 Width="80"
                                                 Margin="8,0,8,0"/>
                                        <TextBlock Grid.Column="2" 
                                                   Text="(24h format: 02:00)"
                                                   VerticalAlignment="Center"
                                                   FontSize="11"
                                                   Foreground="Gray"/>
                                    </Grid>
                                    
                                    <!-- Source Folder -->
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Source Folder:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" Text="{Binding BackupSourceFolder}" 
                                                 materialDesign:HintAssist.Hint="C:\Data"
                                                 Margin="8,0,8,0"/>
                                        <Button Grid.Column="2" Content="Browse"
                                                Command="{Binding BrowseBackupFolderCommand}"
                                                Style="{StaticResource MaterialDesignOutlinedButton}"
                                                Height="32" MinWidth="80"/>
                                    </Grid>
                                    
                                    <!-- File Pattern -->
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="File Pattern:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" Text="{Binding BackupFilePattern}" 
                                                 materialDesign:HintAssist.Hint="*.txt;*.log;*.csv"
                                                 Margin="8,0,0,0"/>
                                    </Grid>
                                    
                                    <!-- Date Filter -->
                                    <Separator Margin="0,12,0,12"/>
                                    <TextBlock Text="File Date Filter" FontWeight="Medium" FontSize="14" Margin="0,0,0,8"/>
                                    
                                    <CheckBox IsChecked="{Binding EnableDateFilter}" 
                                              Content="Only backup files created/modified after specific date"
                                              Margin="0,0,0,8"/>
                                    
                                    <Grid Margin="0,0,0,12" IsEnabled="{Binding EnableDateFilter}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="From Date:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" 
                                                 Text="{Binding BackupFromDateDisplay, Mode=TwoWay}" 
                                                 materialDesign:HintAssist.Hint="yyyy-MM-dd"
                                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                                 Width="120"
                                                 Margin="8,0,8,0"/>
                                        <TextBlock Grid.Column="2" 
                                                   Text="(Format: yyyy-MM-dd, e.g., 2025-09-20)"
                                                   VerticalAlignment="Center"
                                                   FontSize="11"
                                                   Foreground="Gray"/>
                                    </Grid>
                                    
                                    <!-- FTP Settings -->
                                    <Separator Margin="0,12,0,12"/>
                                    <TextBlock Text="FTP Server Settings" FontWeight="Medium" FontSize="14" Margin="0,0,0,8"/>
                                    
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="FTP Server:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" Text="{Binding FtpServer}" 
                                                 materialDesign:HintAssist.Hint="ftp.example.com"
                                                 Margin="8,0,4,0"/>
                                        <TextBox Grid.Column="2" Text="{Binding FtpPort}" 
                                                 materialDesign:HintAssist.Hint="21"
                                                 Margin="4,0,0,0"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Credentials:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" Text="{Binding FtpUsername}" 
                                                 materialDesign:HintAssist.Hint="Username"
                                                 Margin="8,0,4,0"/>
                                        <PasswordBox Grid.Column="2" 
                                                     materialDesign:HintAssist.Hint="Password"
                                                     Margin="4,0,0,0"
                                                     x:Name="FtpPasswordBox"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Remote Folder:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" Text="{Binding FtpRemoteFolder}" 
                                                 materialDesign:HintAssist.Hint="/backup/machine-data"
                                                 Margin="8,0,0,0"/>
                                    </Grid>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                                        <Button Content="Test FTP" 
                                                Command="{Binding TestFtpConnectionCommand}"
                                                Style="{StaticResource MaterialDesignOutlinedButton}"
                                                Margin="0,0,8,0" Padding="12,6" MinWidth="80"/>
                                        <Button Content="Save" 
                                                Command="{Binding SaveBackupSettingsCommand}"
                                                materialDesign:ButtonAssist.CornerRadius="4"
                                                Padding="12,6" MinWidth="80"
                                                Margin="0,0,8,0"/>
                                        <Button Content="Reset" 
                                                Command="{Binding ResetSettingsCommand}"
                                                materialDesign:ButtonAssist.CornerRadius="4"
                                                Padding="12,6" MinWidth="80"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </materialDesign:Card>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- LinkerKosanja Tab -->
            <TabItem Header="LinkerKosanja">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                    <StackPanel>
                        
                        <!-- Linker Kosanja Settings -->
                        <materialDesign:Card Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Text="Linker Kosanja Settings" 
                                           FontSize="20" FontWeight="Medium"
                                           Margin="0,0,0,16"/>
                                
                                <StackPanel Grid.Row="1">
                                    
                                    <!-- Program Path -->
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Program Path:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" Text="{Binding ProgramPath}" 
                                                 materialDesign:HintAssist.Hint="Đường dẫn đến file .exe"
                                                 Margin="8,0,8,0"/>
                                        <Button Grid.Column="2" Content="Browse"
                                                Command="{Binding BrowseProgramPathCommand}"
                                                Style="{StaticResource MaterialDesignOutlinedButton}"
                                                Padding="12,6" MinWidth="80"/>
                                    </Grid>
                                    
                                    <!-- Sub Program Path -->
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Sub Program:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" Text="{Binding SubProgramPath}" 
                                                 materialDesign:HintAssist.Hint="Đường dẫn đến chương trình phụ"
                                                 Margin="8,0,8,0"/>
                                        <Button Grid.Column="2" Content="Browse"
                                                Command="{Binding BrowseSubProgramPathCommand}"
                                                Style="{StaticResource MaterialDesignOutlinedButton}"
                                                Padding="12,6" MinWidth="80"/>
                                    </Grid>
                                    
                                    <!-- Auto Restart -->
                                    <CheckBox IsChecked="{Binding AutoRestartProgram}" 
                                              Content="Auto restart if crashed"
                                              Margin="0,0,0,16"/>
                                    
                                    <!-- Program Status -->
                                    <Grid Margin="0,0,0,16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Status:" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="{Binding ProgramStatus}" 
                                                   VerticalAlignment="Center"
                                                   FontWeight="Medium"
                                                   Margin="8,0,0,0"/>
                                    </Grid>
                                    
                                    <!-- Control Buttons -->
                                    <StackPanel Orientation="Horizontal">
                                        <Button Content="Start" 
                                                Command="{Binding StartProgramCommand}"
                                                materialDesign:ButtonAssist.CornerRadius="4"
                                                Padding="12,6" MinWidth="80"
                                                Margin="0,0,8,0"/>
                                        <Button Content="Stop" 
                                                Command="{Binding StopProgramCommand}"
                                                materialDesign:ButtonAssist.CornerRadius="4"
                                                Padding="12,6" MinWidth="80"
                                                Margin="0,0,8,0"/>
                                        <Button Content="Restart" 
                                                Command="{Binding RestartProgramCommand}"
                                                materialDesign:ButtonAssist.CornerRadius="4"
                                                Padding="12,6" MinWidth="80"/>
                                    </StackPanel>
                                    
                                </StackPanel>
                            </Grid>
                        </materialDesign:Card>
                        
                        <!-- UI Automation Settings -->
                        <materialDesign:Card Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Text="UI Automation Settings" 
                                           FontSize="20" FontWeight="Medium"
                                           Margin="0,0,0,16"/>
                                
                                <StackPanel Grid.Row="1">
                                    
                                    <!-- Enable UI Automation -->
                                    <CheckBox IsChecked="{Binding EnableUIAutomation}" 
                                              Content="Enable UI Automation"
                                              Margin="0,0,0,16"/>
                                    
                                    <!-- Automation Interval -->
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Check Interval (s):" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" Text="{Binding AutomationInterval}" 
                                                 materialDesign:HintAssist.Hint="5"
                                                 Margin="8,0,0,0"/>
                                    </Grid>
                                    
                                    <!-- Test Buttons -->
                                    <StackPanel Orientation="Horizontal" Margin="0,16,0,0">
                                        <Button Content="Test UI" 
                                                Command="{Binding TestUIElementsCommand}"
                                                materialDesign:ButtonAssist.CornerRadius="4"
                                                Padding="12,6" MinWidth="80"
                                                Margin="0,0,8,0"/>
                                        <Button Content="Start Auto" 
                                                Command="{Binding StartAutomationCommand}"
                                                materialDesign:ButtonAssist.CornerRadius="4"
                                                Padding="12,6" MinWidth="80"
                                                Margin="0,0,8,0"/>
                                        <Button Content="Stop Auto" 
                                                Command="{Binding StopAutomationCommand}"
                                                materialDesign:ButtonAssist.CornerRadius="4"
                                                Padding="12,6" MinWidth="80"/>
                                    </StackPanel>
                                    
                                </StackPanel>
                            </Grid>
                        </materialDesign:Card>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
        </TabControl>
    </Grid>
</UserControl>
