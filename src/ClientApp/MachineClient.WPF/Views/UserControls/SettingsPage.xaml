<UserControl x:Class="MachineClient.WPF.Views.UserControls.SettingsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes">
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="20">
            
            <!-- Connection Settings -->
            <materialDesign:Card Padding="20" Margin="0,0,0,20">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Connection Settings" 
                               FontSize="20" FontWeight="Medium"
                               Margin="0,0,0,16"/>
                    
                    <StackPanel Grid.Row="1">
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="API Server URL:" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Text="{Binding ApiServerUrl}" 
                                     materialDesign:HintAssist.Hint="http://localhost:5275"
                                     Margin="8,0,0,0"/>
                        </Grid>
                        
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Connection Timeout:" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Text="{Binding ConnectionTimeout}" 
                                     materialDesign:HintAssist.Hint="30"
                                     Margin="8,0,0,0"/>
                        </Grid>
                        
                        <CheckBox IsChecked="{Binding AutoConnectOnStartup}" 
                                  Content="Auto-connect on startup"
                                  Margin="0,0,0,12"/>
                        
                        <Button Content="Test Connection" 
                                Command="{Binding TestConnectionCommand}"
                                materialDesign:ButtonAssist.CornerRadius="4"
                                HorizontalAlignment="Left"
                                Padding="16,8"/>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>
            
            <!-- Application Settings -->
            <materialDesign:Card Padding="20" Margin="0,0,0,20">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Application Settings" 
                               FontSize="20" FontWeight="Medium"
                               Margin="0,0,0,16"/>
                    
                    <StackPanel Grid.Row="1">
                        <CheckBox IsChecked="{Binding StartMinimized}" 
                                  Content="Start minimized to system tray"
                                  Margin="0,0,0,12"/>
                        
                        <CheckBox IsChecked="{Binding EnableLogging}" 
                                  Content="Enable detailed logging"
                                  Margin="0,0,0,12"/>
                        
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Log Level:" VerticalAlignment="Center"/>
                            <ComboBox Grid.Column="1" SelectedValue="{Binding LogLevel}" Margin="8,0,0,0">
                                <ComboBoxItem Content="Error" Tag="Error"/>
                                <ComboBoxItem Content="Warning" Tag="Warning"/>
                                <ComboBoxItem Content="Info" Tag="Info"/>
                                <ComboBoxItem Content="Debug" Tag="Debug"/>
                            </ComboBox>
                        </Grid>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Update Interval (s):" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Text="{Binding UpdateInterval}" 
                                     materialDesign:HintAssist.Hint="30"
                                     Margin="8,0,0,0"/>
                        </Grid>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>
            
            <!-- Backup Settings -->
            <materialDesign:Card Padding="20" Margin="0,0,0,20">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Backup Settings" 
                               FontSize="20" FontWeight="Medium"
                               Margin="0,0,0,16"/>
                    
                    <StackPanel Grid.Row="1">
                        <!-- Backup Plan -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Backup Plan:" VerticalAlignment="Center"/>
                            <ComboBox Grid.Column="1" 
                                      SelectedItem="{Binding BackupPlan}"
                                      Margin="8,0,0,0">
                                <ComboBoxItem Content="Hourly"/>
                                <ComboBoxItem Content="Daily"/>
                                <ComboBoxItem Content="Weekly"/>
                                <ComboBoxItem Content="Manual"/>
                            </ComboBox>
                        </Grid>
                        
                        <!-- Scheduled Backup Time -->
                        <CheckBox IsChecked="{Binding EnableScheduledBackup}" 
                                  Content="Enable scheduled backup"
                                  Margin="0,0,0,8"/>
                        
                        <Grid Margin="0,0,0,12" IsEnabled="{Binding EnableScheduledBackup}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Backup Time:" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" 
                                     Text="{Binding BackupTimeDisplay, Mode=TwoWay}" 
                                     materialDesign:HintAssist.Hint="HH:mm"
                                     Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                     Width="80"
                                     Margin="8,0,8,0"/>
                            <TextBlock Grid.Column="2" 
                                       Text="(24-hour format, e.g., 02:00 for 2:00 AM)"
                                       VerticalAlignment="Center"
                                       FontSize="11"
                                       Foreground="Gray"/>
                        </Grid>
                        
                        <!-- Date Filter Section -->
                        <Separator Margin="0,12,0,12"/>
                        <TextBlock Text="File Date Filter" FontWeight="Medium" FontSize="14" Margin="0,0,0,8"/>
                        
                        <CheckBox IsChecked="{Binding EnableDateFilter}" 
                                  Content="Only backup files created/modified after specific date"
                                  Margin="0,0,0,8"/>
                        
                        <Grid Margin="0,0,0,12" IsEnabled="{Binding EnableDateFilter}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="From Date:" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" 
                                     Text="{Binding BackupFromDateDisplay, Mode=TwoWay}" 
                                     materialDesign:HintAssist.Hint="yyyy-MM-dd"
                                     Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                     Width="120"
                                     Margin="8,0,8,0"/>
                            <TextBlock Grid.Column="2" 
                                       Text="(Format: yyyy-MM-dd, e.g., 2025-09-20)"
                                       VerticalAlignment="Center"
                                       FontSize="11"
                                       Foreground="Gray"/>
                        </Grid>
                        
                        <Grid Margin="0,0,0,12" IsEnabled="{Binding EnableScheduledBackup}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Backup Time:" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" 
                                     Text="{Binding BackupTimeDisplay}" 
                                     materialDesign:HintAssist.Hint="HH:mm"
                                     Width="80"
                                     Margin="8,0,8,0"/>
                            <TextBlock Grid.Column="2" 
                                       Text="(24-hour format, e.g., 02:00 for 2:00 AM)"
                                       VerticalAlignment="Center"
                                       FontSize="11"
                                       Foreground="Gray"/>
                        </Grid>
                        
                        <!-- Source Folder -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Source Folder:" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Text="{Binding BackupSourceFolder}" 
                                     materialDesign:HintAssist.Hint="C:\Data"
                                     Margin="8,0,8,0"/>
                            <Button Grid.Column="2" Content="Browse"
                                    Command="{Binding BrowseBackupFolderCommand}"
                                    Style="{StaticResource MaterialDesignOutlinedButton}"
                                    Height="32"/>
                        </Grid>
                        
                        <!-- File Pattern -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="File Pattern:" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Text="{Binding BackupFilePattern}" 
                                     materialDesign:HintAssist.Hint="*.txt;*.log;*.csv"
                                     Margin="8,0,0,0"/>
                        </Grid>
                        
                        <!-- FTP Settings -->
                        <Separator Margin="0,12,0,12"/>
                        <TextBlock Text="FTP Server Settings" FontWeight="Medium" FontSize="14" Margin="0,0,0,8"/>
                        
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="FTP Server:" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Text="{Binding FtpServer}" 
                                     materialDesign:HintAssist.Hint="ftp.example.com"
                                     Margin="8,0,4,0"/>
                            <TextBox Grid.Column="2" Text="{Binding FtpPort}" 
                                     materialDesign:HintAssist.Hint="21"
                                     Margin="4,0,0,0"/>
                        </Grid>
                        
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Credentials:" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Text="{Binding FtpUsername}" 
                                     materialDesign:HintAssist.Hint="Username"
                                     Margin="8,0,4,0"/>
                            <PasswordBox Grid.Column="2" 
                                         materialDesign:HintAssist.Hint="Password"
                                         Margin="4,0,0,0"
                                         x:Name="FtpPasswordBox"/>
                        </Grid>
                        
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Remote Folder:" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Text="{Binding FtpRemoteFolder}" 
                                     materialDesign:HintAssist.Hint="/backup/machine-data"
                                     Margin="8,0,0,0"/>
                        </Grid>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                            <Button Content="Test FTP Connection" 
                                    Command="{Binding TestFtpConnectionCommand}"
                                    Style="{StaticResource MaterialDesignOutlinedButton}"
                                    Margin="0,0,8,0"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>
            
            <!-- Save Settings -->
            <materialDesign:Card Padding="16">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button Content="Save Settings" 
                            Command="{Binding SaveBackupSettingsCommand}"
                            materialDesign:ButtonAssist.CornerRadius="4"
                            Padding="16,8"
                            Margin="0,0,8,0"/>
                    <Button Content="Reset to Default" 
                            Command="{Binding ResetSettingsCommand}"
                            materialDesign:ButtonAssist.CornerRadius="4"
                            Padding="16,8"/>
                </StackPanel>
            </materialDesign:Card>
            
        </StackPanel>
    </ScrollViewer>
</UserControl>